#!/usr/bin/env ruby

require_relative '../lib/common'
include Common

hash = JSON.parse(File.read("#{site_directory}/product_details.json"))
hash.delete('总数')

hash.map {|key, value| value['图片原始链接'].zip value['图片本地链接'] }.flatten(1).each_slice(30) do |filenames|
  filenames.each do |filename|
    spawn("wget -t5 -nc \"#{filename[0]}\" -O \"#{filename[1]}\"")
  end
  sleep 5
end
